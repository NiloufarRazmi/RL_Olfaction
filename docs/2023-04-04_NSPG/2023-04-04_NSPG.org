#+TITLE: Learning useful representations to solve a place-odor association task
# #+SUBTITLE: NSGP seminar
# #+SUBTITLE: (Reinforcement) learning of an odor-place association task
#+author: Andrea Pierr√©
#+date: April 4, 2023
* COMMENT Add plain option to Beamer TOC
% Local variables:
% org-beamer-outline-frame-options: "plain"
% End:
* HEADER :noexport:
#+SETUPFILE: ./style.org

* Context of the project
* Context
:PROPERTIES:
:UNNUMBERED: notoc
:END:
#+begin_export latex
{%
\setbeamertemplate{background canvas}{\includegraphics[height=\paperheight]{img/kitchen1.png}}
\begin{frame}[fragile]{Odor-place association}
\end{frame}
}
#+end_export
* Context
:PROPERTIES:
:UNNUMBERED: notoc
:END:
#+begin_export latex
{%
\setbeamertemplate{background canvas}{\includegraphics[height=\paperheight]{img/kitchen2.png}}
\begin{frame}[fragile]{Odor-place association}
\addtocounter{framenumber}{-1}
\end{frame}
}
#+end_export
* Context
:PROPERTIES:
:UNNUMBERED: notoc
:END:
#+begin_export latex
{%
\setbeamertemplate{background canvas}{\includegraphics[height=\paperheight]{img/kitchen3.png}}
\begin{frame}[fragile]{Odor-place association}
\addtocounter{framenumber}{-1}
\end{frame}
}
#+end_export
** Why we are interested in the LEC ?
*** Text :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:BEAMER_act: [<+->]
:END:
#+begin_export latex
\pause
\scriptsize
\footnotesize
\begin{itemize}[<+->]
\item The LEC is key to sensory associations and spatial memory
\begin{itemize}
\scriptsize
\item LEC is needed for learning sensory associations and certain spatial memory tasks
\item Individual cells are tuned to goal, object, and sensory cue locations
\end{itemize}
\item The LEC connects sensory information to the HPC
\begin{itemize}
\scriptsize
\item LEC and HPC are strongly and reciprocally connected
\item Direct olfactory connections from OB and piriform
\end{itemize}
\end{itemize}
#+end_export
*** Image :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :width \textwidth
[[file:img/connectivity.png]]

** Olivia's diamond arena olfactory task
*** Allocentric :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:BEAMER_opt: [t]
:END:
#+begin_export latex
\center
#+end_export
Allocentric\\
(go west/east)
#+ATTR_LaTeX: :width 0.8\textwidth
[[file:img/allocentric-task.png]]

*** Egocentric :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:BEAMER_opt: [t]
:END:
#+begin_export latex
\center
#+end_export
Egocentric\\
(go right/left)
#+ATTR_LaTeX: :width 0.8\textwidth
[[file:img/egocentric-task.png]]

#+begin_export latex
\begin{textblock}{5}(-1,13)
\center
\includegraphics[width=3em]{img/olivia.jpg}\\
\scriptsize
Olivia McKissick
\end{textblock}
#+end_export

# #+begin_export latex
# \scriptsize
# #+end_export
# #+ATTR_LATEX: :center t  :align cp{3em}c
# | Allocentric |   | Egocentric       |
# | (go right)  |   | (always go west) |

** Diamond arena experimental setup
[[file:img/physical-diamond-arena.png]]
** What is Reinforcement Learning and why we want to use it ?
*** Diagram :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:
#+ATTR_LaTeX: :width \textwidth

#+INCLUDE: "./RL.tex" src latex

*** Ideas :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.4
:BEAMER_act: [<+->]
:END:
#+begin_export latex
\small
#+end_export
- Goal of the agent : maximize rewards
- Natural fit for behavioral experiments involving rewards and learning

** Temporal Difference learning
*** Illustration :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :height 0.8\textheight
[[./img/RL_mapping.drawio.png]]
*** Equation :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+begin_export latex
\begin{adjustbox}{max width=\columnwidth, keepaspectratio}
$V(S_t) = V(S_t) + \alpha(\underbrace{R_{t+1} + \gamma V(S_{t+1})}_\text{TD target} - V(S_t))$
\end{adjustbox}\\[1em]
\begin{adjustbox}{max width=\columnwidth, keepaspectratio}
$NewEstimate \leftarrow OldEstimate + StepSize[Target - OldEstimate]$
\end{adjustbox}
#+end_export
* Question
:PROPERTIES:
:UNNUMBERED: notoc
:END:
#+begin_export latex
\begin{frame}[fragile]{}
\metroset{block=fill}
\begin{exampleblock}{Question}
Which representations are needed by the brain to learn a place-odor association task ?
\end{exampleblock}
\end{frame}
#+end_export
* Experiments & preliminary results
** The model
*** Allocentric :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+begin_export latex
\center
#+end_export
Allocentric
#+ATTR_LaTeX: :width \textwidth
[[file:img/RL_environment-Allo.drawio.png]]
*** Egocentric :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
** The model
#+begin_export latex
\addtocounter{framenumber}{-1}
#+end_export
*** Allocentric :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+begin_export latex
\center
#+end_export
Allocentric
#+ATTR_LaTeX: :width \textwidth
[[file:img/RL_environment-Allo.drawio.png]]
*** Egocentric :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+begin_export latex
\center
#+end_export
Egocentric
#+ATTR_LaTeX: :width \textwidth
[[file:img/RL_environment-Ego.drawio.png]]
** With joint representation
*** Left :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :height 0.4\textheight
[[file:img/features-allo-joint-repr.png]]
*** Right :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :width \textwidth
[[file:img/policy-allo-joint-repr.png]]
*** \nbsp{}
#+begin_export latex
\vspace{-2em}
#+end_export
#+ATTR_LaTeX: :height 0.4\textheight
[[file:img/rewards-steps-allo-joint-repr.png]]
\to The agent learns to solve the task
** Without joint representation
*** Left :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :height 0.4\textheight
[[file:img/features-allo-no-joint-repr.png]]
*** Right :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :width \textwidth
[[file:img/policy-allo-no-joint-repr.png]]
*** \nbsp{}
#+begin_export latex
\vspace{-2em}
#+end_export
#+ATTR_LaTeX: :height 0.4\textheight
[[file:img/rewards-steps-allo-no-joint-repr.png]]
\to The agent is unable to solve the task
* Next steps
** From tabular RL to deep RL
#+begin_export latex
\center
#+end_export
#+INCLUDE: "./RL-tab.tex" src latex
** From tabular RL to deep RL
#+begin_export latex
\center
\addtocounter{framenumber}{-1}
#+end_export
#+INCLUDE: "./RL-nn.tex" src latex
** What are the representations needed to solve the task ?
*** Schema :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+ATTR_LaTeX: :height 0.25\textheight
[[file:img/place-cells-grid-cells.jpg.png]]
[[file:img/nn.svg.png]]
*** Text :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:BEAMER_act: [<+->]
:END:
1. Look for candidate patterns in the data: place cells, grid cells,\dots?
2. Compare the data with the representations learned from scratch by the neural network

#+begin_export latex
\begin{textblock}{5}(0,12)
\begin{minipage}[t]{3em}
\center
\includegraphics[height=2em]{img/matt-nassar.jpg}\\
\scriptsize
Matt Nassar
\end{minipage}
\begin{minipage}[t]{3em}
\center
\includegraphics[height=2em]{img/niloufar-razmi.jpeg}\\
\scriptsize
Niloufar Razmi
\end{minipage}
\end{textblock}
#+end_export

** Summary
* Acknowledgments
:PROPERTIES:
:UNNUMBERED: notoc
:END:
#+begin_export latex
{%
\setbeamertemplate{background canvas}{\includegraphics[height=\paperheight]{img/grand-canyon.JPG}}
\begin{frame}[fragile,t, plain]{Acknowledgments}
    \vspace{1em}
    \begin{columns}[T]
        \begin{column}{0.5\textwidth}
            \begin{itemize}
                \small
                \item Fleischmann lab
                \begin{itemize}
                    \tiny
                    \item Alexander Fleischmann
                    \item Keeley Baker
                    \item Olivia Mckissick
                    \item Tuan Pham
                    \item Simon Daste
                    \item Max Seppo
                    %\item \colorbox{white}{\transparent{0.2}Sara Zeppilli}}
                    \item Sara Zeppilli
                    \item Nell Klimpert
                    \item Erin Meyers
                    \item Eseosa Uwaifo
                    \item Camille Donoho
                    \item Timothy Pyon
                \end{itemize}
            \end{itemize}
            \vspace{4em}
            \hspace{1.5em}\includegraphics[height=1.5cm]{img/qr-code.png}
        \end{column}

        \begin{column}{0.5\textwidth}
            \begin{itemize}
                \small
                \item Collaborations
                \begin{itemize}
                    \tiny
                    \item Jason Ritt
                    \item Matt Nassar
                    \item Niloufar Razmi
                \end{itemize}
            \end{itemize}
        \end{column}
    \end{columns}
\end{frame}
}
#+end_export
* Feedback :noexport:
** What is LEC?
- region
- It seems to have information about
- Lab is working on it and recording
** First slide with a picture
** Start with the experiment?
** Or start with RL or the brain?
** What is this talk about?
** Define the problem/example
Learning with association \to I know where to get it
** Anatomical intro
*** DONE Ask Olivia
*** Hyp/LEC/PCx
** Hyp
*** Intro of each term
**** LEC
**** Conjunctive
*** Maybe only the question, no hypothesis
*** Follow-up question: what representations might work?
**** Because network
** We think RL is implemented in the brain
Another player that has a teaching signal == dopamine
Representation we might find in the temporal lobe
Efficient RL + successful solving task
** Task first
** Schema with mapping from states to actions
- Animated
- With the equation with pieces highlited on the right
** Introduce congiuntuve code like Niloufar
** Present plots sequentially
- Box to highlight?
** Add a line of the plot's takeaway
** Declarative title
Ex: Model without joint repr fail to learn the task
** Show with joit repr before to show what it should get
** Explain policy with schema of animal and arrows options
** Add odor + puff of air icons on policy plots
** States occupancy \to just explain what we could do
** Back and forth with the model and data
- Where agent/animal spends its time?
** Now we want to go in these directions
** What representations can support this learning?
*** Can't separate odor and place encoding
*** Can
** Replace ticks with categories
** Design
*** Small multiples
*** General > specific > general
*** Paralellism
*** Ratio of info on the slides
** Replace Episode by trial
** Remove 3 times
** Put steps on the left
** What it changes it how many steps it taks to get there
** Add n=3 agents ?
